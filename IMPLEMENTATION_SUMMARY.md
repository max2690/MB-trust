# –ò—Ç–æ–≥–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ MB-TRUST

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### üé® UI –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (–ì–æ—Ç–æ–≤–æ)
- ‚úÖ `BalanceCard` - –ö—Ä–∞—Å–∏–≤–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –±–∞–ª–∞–Ω—Å–∞ —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º–∏
- ‚úÖ `DepositForm` - –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ YooKassa
- ‚úÖ `PayoutForm` - –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–≤–æ–¥–∞ —á–µ—Ä–µ–∑ Telegram Wallet/Tribute
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã –¥–∞—à–±–æ—Ä–¥—ã (customer –∏ executor)

### üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–ì–æ—Ç–æ–≤–æ)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –≤ `User` (IP, –≥–æ—Ä–æ–¥, —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –≤ `Order` (—Ü–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –≤ `Execution` (IP, –≤—Ä–µ–º—è, –≥–æ—Ä–æ–¥)
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞

### üó∫Ô∏è –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è (–ì–æ—Ç–æ–≤–æ)
- ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `LocationSelector` —Å —Ç—Ä–µ–º—è —Ä–µ–∂–∏–º–∞–º–∏ (—Å—Ç—Ä–∞–Ω–∞/—Ä–µ–≥–∏–æ–Ω/–≥–æ—Ä–æ–¥)
- ‚úÖ DaData API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–ª—è –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è
- ‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–π fallback –Ω–∞ 54 –≥–æ—Ä–æ–¥–∞
- ‚úÖ –ì–µ–æ—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π

### üí∞ –ü–ª–∞—Ç–µ–∂–∏ (–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–∞—Å—Ç–∏—á–Ω–æ –≥–æ—Ç–æ–≤–∞)
- ‚úÖ UI —Ñ–æ—Ä–º—ã –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –≤—ã–≤–æ–¥–∞
- ‚úÖ YooKassa webhook endpoint
- ‚úÖ Tribute API endpoint
- ‚ö†Ô∏è –¢—Ä–µ–±—É—é—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–µ API –∫–ª—é—á–∏

### ü§ñ AI –ü—Ä–æ–≤–µ—Ä–∫–∞ (–ì–æ—Ç–æ–≤–æ)
- ‚úÖ OpenAI Vision API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ QR-–∫–æ–¥–æ–≤ –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞—Ö
- ‚úÖ –ó–∞–≥–ª—É—à–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∫–ª—é—á–∞

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¥–ª—è –∑–∞–ø—É—Å–∫–∞

### 1. –ü–æ–ª—É—á–∏—Ç—å API –∫–ª—é—á–∏

#### OpenAI (–¥–ª—è AI –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤)
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: https://platform.openai.com/signup
- –ö–ª—é—á: https://platform.openai.com/api-keys
- –î–æ–±–∞–≤–∏—Ç—å –≤ `.env.local`:
  ```env
  OPENAI_API_KEY="sk-your-actual-key"
  ```

#### DaData (–¥–ª—è –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è –∞–¥—Ä–µ—Å–æ–≤)
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: https://dadata.ru/registration/
- –ö–ª—é—á: https://dadata.ru/profile/#info
- –î–æ–±–∞–≤–∏—Ç—å –≤ `.env.local`:
  ```env
  DADATA_API_KEY="your-dadata-token"
  ```

#### YooKassa (–¥–ª—è –ø—Ä–∏–µ–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π)
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: https://yookassa.ru/registration/
- Shop ID –∏ Secret Key: https://yookassa.ru/my/
- –î–æ–±–∞–≤–∏—Ç—å –≤ `.env.local`:
  ```env
  YOOKASSA_SHOP_ID="your-shop-id"
  YOOKASSA_SECRET_KEY="your-secret-key"
  ```

#### Tribute (–¥–ª—è –≤—ã–ø–ª–∞—Ç –≤ Telegram Wallet)
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: https://tribute.app/
- API Key: https://tribute.app/dashboard/settings
- –î–æ–±–∞–≤–∏—Ç—å –≤ `.env.local`:
  ```env
  TRIBUTE_API_KEY="your-tribute-api-key"
  ```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç—ã (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

```bash
npm install @yoomoney/yookassa-sdk  # –ö–æ–≥–¥–∞ –≥–æ—Ç–æ–≤ YooKassa SDK
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä

```bash
npm run dev
```

## üéØ API Endpoints

### –ü–ª–∞—Ç–µ–∂–∏
- `POST /api/payments/create` - –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
- `POST /api/payments/yookassa/webhook` - Webhook –æ—Ç YooKassa
- `GET /api/payments/yookassa/stub` - –ó–∞–≥–ª—É—à–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –æ–ø–ª–∞—Ç—ã

### –í—ã–ø–ª–∞—Ç—ã
- `POST /api/payouts` - –°–æ–∑–¥–∞–Ω–∏–µ –≤—ã–ø–ª–∞—Ç—ã
- `POST /api/payouts/tribute` - Tribute API

### –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è
- `GET /api/location/autocomplete?q=–ú–æ—Å–∫–≤–∞&type=city` - DaData –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ

### –ó–∞–∫–∞–∑—ã
- `GET /api/orders?role=executor&userId=xxx` - –ó–∞–∫–∞–∑—ã —Å –≥–µ–æ—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- `POST /api/orders` - –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ —Å –≥–µ–æ–ª–æ–∫–∞—Ü–∏–µ–π

### AI
- `POST /api/ai/verify-screenshot` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ —á–µ—Ä–µ–∑ OpenAI

## üîÑ –ü–æ—Ç–æ–∫ —Ä–∞–±–æ—Ç—ã

### –î–ª—è –∑–∞–∫–∞–∑—á–∏–∫–∞:
1. –°–æ–∑–¥–∞–µ—Ç –∑–∞–∫–∞–∑ —Å –≤—ã–±–æ—Ä–æ–º –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ (–≤—Å—è —Å—Ç—Ä–∞–Ω–∞/—Ä–µ–≥–∏–æ–Ω/–≥–æ—Ä–æ–¥)
2. –ü–æ–ø–æ–ª–Ω—è–µ—Ç –±–∞–ª–∞–Ω—Å —á–µ—Ä–µ–∑ YooKassa (–∫—Ä–∞—Å–∏–≤–∞—è —Ñ–æ—Ä–º–∞)
3. –ó–∞–∫–∞–∑ –≤–∏–¥–µ–Ω —Ç–æ–ª—å–∫–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è–º –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —Ä–µ–≥–∏–æ–Ω–µ

### –î–ª—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è:
1. –í–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ –∑–∞–∫–∞–∑—ã –≤ —Å–≤–æ–µ–º —Ä–µ–≥–∏–æ–Ω–µ
2. –ë–µ—Ä–µ—Ç –∑–∞–∫–∞–∑, —Ä–∞–∑–º–µ—â–∞–µ—Ç —Å—Ç–æ—Ä–∏—Å, –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–∫—Ä–∏–Ω—à–æ—Ç
3. AI –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–∫—Ä–∏–Ω—à–æ—Ç (QR-–∫–æ–¥, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ, –∫–∞—á–µ—Å—Ç–≤–æ)
4. –ü–æ–ª—É—á–∞–µ—Ç –¥–µ–Ω—å–≥–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
5. –í—ã–≤–æ–¥–∏—Ç –Ω–∞ Telegram Wallet —á–µ—Ä–µ–∑ Tribute (–∫—Ä–∞—Å–∏–≤–∞—è —Ñ–æ—Ä–º–∞)

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ API –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞–±–æ—Ç–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏
- –ó–∞–≥–ª—É—à–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ –∫–ª—é—á–µ–π
- –ì–µ–æ—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î –∏ API
- AI –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ OpenAI Vision
- UI –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∏ –∫—Ä–∞—Å–∏–≤—ã–π

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ API –∫–ª—é—á–∏
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å webhook URL –≤ YooKassa
4. –ü—Ä–∏–≤—è–∑–∞—Ç—å Telegram Wallet —á–µ—Ä–µ–∑ –±–æ—Ç–∞
5. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –±–∞–∑—É –≥–æ—Ä–æ–¥–æ–≤ (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DaData)

---

## üîå Internal API (–ù–û–í–û–ï!)

### ‚úÖ –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ:
- ‚úÖ **–ú–æ–¥–µ–ª—å ApiKey** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ API –∫–ª—é—á–∞–º–∏ –≤ –ë–î
- ‚úÖ **Middleware** - –ü—Ä–æ–≤–µ—Ä–∫–∞ API –∫–ª—é—á–µ–π –∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ **Endpoints v1**:
  - `GET /api/v1/orders` - –ü–æ–ª—É—á–∏—Ç—å –∑–∞–∫–∞–∑—ã
  - `POST /api/v1/orders` - –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑
  - `GET /api/v1/executions` - –ü–æ–ª—É—á–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
  - `POST /api/v1/executions` - –ü—Ä–∏–Ω—è—Ç—å –∑–∞–∫–∞–∑
  - `GET /api/v1/users` - –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ **–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å** - `/admin-god/api-keys` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª—é—á–∞–º–∏
- ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - `INTERNAL_API_DOCS.md`

### üì± –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
```bash
curl -H "X-API-Key: your-key" https://your-domain.com/api/v1/orders
```

### üí∞ –ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:
- ‚úÖ **–°–ë–ü** - –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è –¥–ª—è –≤—ã–ø–ª–∞—Ç —á–µ—Ä–µ–∑ –°–ë–ü
- ‚úÖ **–ê–≤—Ç–æ–≤—ã–ø–ª–∞—Ç–∞** - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã–ø–ª–∞—Ç
- ‚úÖ **YooKassa** - –ü—Ä–∏–µ–º –ø–ª–∞—Ç–µ–∂–µ–π –æ—Ç –∑–∞–∫–∞–∑—á–∏–∫–æ–≤
- ‚úÖ **Tribute** - –í—ã–ø–ª–∞—Ç—ã –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è–º –≤ Telegram Wallet

### –ü–æ—Ç–æ–∫ —Å—Ä–µ–¥—Å—Ç–≤:
```
–ó–∞–∫–∞–∑—á–∏–∫ (YooKassa) ‚Üí –í–∞—à Telegram Wallet ‚Üí –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å (Tribute)
```

